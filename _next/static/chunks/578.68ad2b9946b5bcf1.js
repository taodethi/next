"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{3578:function(e,t,l){l.r(t),l.d(t,{default:function(){return E}});var i=l(5893),a=l(7294);l(329);var n=l(9920),o=l(142),r=l(8552),s=e=>{let{isOpen:t,onClose:l,onInsert:n}=e,[s,c]=(0,a.useState)({url:"",alt:"",lazy:!1}),[d,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1),[g,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t&&(c({url:"https://cdn.pixabay.com/photo/2020/07/12/18/25/background-5398296_640.png",alt:"Hihi",lazy:!1}),u(""))},[t]);let b=(0,a.useCallback)(e=>{let{name:t,value:l,type:i,checked:a}=e.target;c(e=>({...e,[t]:"checkbox"===i?a:l})),u("")},[]),f=(0,a.useCallback)(async e=>{let t=e.target.files[0];if(t){m(!0);try{let e=await (0,o.gN)(t);if(!e)throw Error("Kh\xf4ng thể tải l\xean h\xecnh ảnh");let l=new Image;l.onload=()=>{c(l=>({...l,url:e,alt:l.alt||t.name.replace(/\.[^/.]+$/,"")})),m(!1)},l.onerror=()=>{throw Error("Kh\xf4ng thể tải h\xecnh ảnh")},l.src=e}catch(l){console.error("Lỗi khi tải l\xean h\xecnh ảnh:",l);let e=new FileReader;e.onloadend=()=>{let l=e.result;c(e=>({...e,url:l,alt:e.alt||t.name.replace(/\.[^/.]+$/,"")})),m(!1)},e.onerror=()=>{u("Kh\xf4ng thể tải h\xecnh ảnh"),m(!1)},e.readAsDataURL(t)}}},[]),x=(0,a.useCallback)(async()=>{if(!s.url){u("Vui l\xf2ng tải l\xean hoặc nhập URL h\xecnh ảnh trước khi n\xe9n");return}p(!0);try{let e=await (0,o.hv)(s.url);c(t=>({...t,url:e}))}catch(e){console.error("Lỗi khi n\xe9n h\xecnh ảnh:",e),u("Kh\xf4ng thể n\xe9n h\xecnh ảnh")}finally{p(!1)}},[s.url]),y=(0,a.useCallback)(()=>{s.url.trim()?n(s):u("Vui l\xf2ng tải l\xean hoặc nhập URL h\xecnh ảnh")},[s,n]),v=(0,a.useMemo)(()=>"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1200] transition-opacity duration-300 ease-in-out ".concat(t?"opacity-100":"opacity-0 pointer-events-none"),[t]),w=(0,a.useMemo)(()=>"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg transform transition-all duration-300 ease-in-out ".concat(t?"scale-100 opacity-100":"scale-95 opacity-0"," w-full max-w-3xl max-h-[90vh] flex flex-col"),[t]),k=(0,a.useMemo)(()=>(0,i.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-2 flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 transition-colors duration-200 ease-in-out relative",onClick:()=>document.getElementById("fileInput").click(),children:[(h||g)&&(0,i.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white"})}),(0,i.jsx)("img",{src:s.url||r.default.coverDefault,alt:s.alt||"Xem trước h\xecnh ảnh",className:"max-w-full h-auto object-contain mb-2"}),(0,i.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Nhấn để tải ảnh l\xean"})]}),[s.url,s.alt,h,g]);return(0,i.jsx)("div",{className:v,children:(0,i.jsxs)("div",{className:w,children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:"Ch\xe8n h\xecnh ảnh"}),d&&(0,i.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 rounded-md shadow-sm",children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("svg",{className:"w-6 h-6 mr-2",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,i.jsx)("p",{className:"font-semibold",children:d})]})}),(0,i.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,i.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,i.jsxs)("div",{className:"w-full md:w-1/2",children:[k,(0,i.jsx)("input",{id:"fileInput",type:"file",accept:"image/*",onChange:f,className:"hidden"})]}),(0,i.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,i.jsx)("input",{type:"text",name:"url",value:s.url,onChange:b,placeholder:"URL h\xecnh ảnh",className:"w-full p-2 mb-4 border rounded dark:bg-gray-700 dark:text-white transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,i.jsx)("input",{type:"text",name:"alt",value:s.alt,onChange:b,placeholder:"Văn bản thay thế (alt)",className:"w-full p-2 mb-4 border rounded dark:bg-gray-700 dark:text-white transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)("input",{type:"checkbox",id:"lazyLoading",name:"lazy",checked:s.lazy,onChange:b,className:"mr-2"}),(0,i.jsx)("label",{htmlFor:"lazyLoading",className:"text-sm dark:text-white",children:"Sử dụng lazy loading"})]}),(0,i.jsx)("button",{onClick:x,disabled:g||!s.url,className:" hidden w-full bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors duration-200 ease-in-out ".concat(g||!s.url?"opacity-50 cursor-not-allowed":""),children:g?"Đang n\xe9n...":"N\xe9n h\xecnh ảnh"})]})]})}),(0,i.jsxs)("div",{className:"flex justify-end mt-6",children:[(0,i.jsx)("button",{onClick:y,disabled:h||g,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 mr-2 transition-colors duration-200 ease-in-out ".concat(h||g?"opacity-50 cursor-not-allowed":""),children:h||g?"Đang xử l\xfd...":"Ch\xe8n"}),(0,i.jsx)("button",{onClick:l,className:"bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 transition-colors duration-200 ease-in-out",children:"Hủy"})]})]})})},c=e=>{let{isOpen:t,onClose:l,onInsert:n}=e,[o,r]=(0,a.useState)({url:"",autoplay:!1,controls:!0,title:"",mute:!1}),[s,c]=(0,a.useState)("");(0,a.useEffect)(()=>{t&&(r({url:"",autoplay:!1,controls:!0,title:"",mute:!1}),c(""))},[t]);let d=(0,a.useCallback)(e=>{let{name:t,value:l,type:i,checked:a}=e.target;r(e=>({...e,[t]:"checkbox"===i?a:l})),c("")},[]),u=(0,a.useCallback)(()=>{console.log("videoData",o),o.url.trim()?n(o):c("Vui l\xf2ng nhập URL video")},[o,n]),h=(0,a.useMemo)(()=>"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300 ease-in-out ".concat(t?"opacity-100":"opacity-0 pointer-events-none"),[t]),m=(0,a.useMemo)(()=>"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg transform transition-all duration-300 ease-in-out ".concat(t?"scale-100 opacity-100":"scale-95 opacity-0"," w-full max-w-3xl max-h-[90vh] flex flex-col"),[t]),g=(0,a.useMemo)(()=>{if(!o.url)return(0,i.jsx)("div",{className:"w-full h-48 bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-500 dark:text-gray-400",children:"Nhập URL video để xem trước"});let e=o.url;if(o.url.includes("youtube.com")||o.url.includes("youtu.be")){let t=o.url.split("v=")[1]||o.url.split("/").pop();e="https://www.youtube.com/embed/".concat(t),o.mute&&(e+="&mute=1")}else{if(!o.url.includes("vimeo.com"))return(0,i.jsx)("div",{className:"relative pb-[56.25%] h-0 overflow-hidden",children:(0,i.jsx)("video",{src:o.url,title:o.title||"Video preview",controls:o.controls,autoPlay:o.autoplay,muted:o.mute,className:"absolute top-0 left-0 w-full h-full",children:"Your browser does not support the video tag."})});let t=o.url.split("/").pop();e="https://player.vimeo.com/video/".concat(t),o.mute&&(e+="?muted=1")}return(0,i.jsx)("div",{className:"relative pb-[56.25%] h-0 overflow-hidden",children:(0,i.jsx)("iframe",{src:e,title:o.title||"Video preview",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"absolute top-0 left-0 w-full h-full"})})},[o.url,o.title,o.mute,o.controls,o.autoplay]);return(0,i.jsx)("div",{className:h,children:(0,i.jsxs)("div",{className:m,children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:"Ch\xe8n video"}),s&&(0,i.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 rounded-md shadow-sm",children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,i.jsx)("p",{className:"font-medium",children:s})]})}),(0,i.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,i.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,i.jsx)("div",{className:"w-full md:w-1/2",children:(0,i.jsx)("div",{className:"mb-4 h-0 pb-[56.25%] relative",children:g})}),(0,i.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,i.jsx)("input",{type:"text",name:"url",value:o.url,onChange:d,placeholder:"URL video (YouTube, Vimeo hoặc URL trực tiếp)",className:"w-full p-2 mb-4 border rounded dark:bg-gray-700 dark:text-white transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,i.jsx)("input",{type:"text",name:"title",value:o.title,onChange:d,placeholder:"Ti\xeau đề video",className:"w-full p-2 mb-4 border rounded dark:bg-gray-700 dark:text-white transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)("input",{type:"checkbox",id:"autoplay",name:"autoplay",checked:o.autoplay,onChange:d,className:"mr-2"}),(0,i.jsx)("label",{htmlFor:"autoplay",className:"dark:text-white",children:"Tự động ph\xe1t"})]}),(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)("input",{type:"checkbox",id:"controls",name:"controls",checked:o.controls,onChange:d,className:"mr-2"}),(0,i.jsx)("label",{htmlFor:"controls",className:"dark:text-white",children:"Hiển thị điều khiển"})]}),(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)("input",{type:"checkbox",id:"mute",name:"mute",checked:o.mute,onChange:d,className:"mr-2"}),(0,i.jsx)("label",{htmlFor:"mute",className:"dark:text-white",children:"Tắt tiếng"})]})]})]})}),(0,i.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,i.jsx)("button",{onClick:u,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors duration-200 ease-in-out",children:"Ch\xe8n"}),(0,i.jsx)("button",{onClick:l,className:"px-4 py-2 mr-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white transition-colors duration-200 ease-in-out",children:"Hủy"})]})]})})},d=e=>{let{data:t,onClose:l,onInsert:n}=e,o={url:"",text:"",target:!1,rel:!1},[r,s]=(0,a.useState)(o),[c,d]=(0,a.useState)("");(0,a.useEffect)(()=>{t.isOpen&&(s({...o,...t}),d(""))},[t]);let u=e=>{let{name:t,value:l}=e.target;s(e=>({...e,[t]:l})),d("")},h=e=>/[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/gi.test(e);return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300 ease-in-out ".concat(t.isOpen?"opacity-100":"opacity-0 pointer-events-none"),children:(0,i.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg transform transition-all duration-300 ease-in-out ".concat(t.isOpen?"scale-100 opacity-100":"scale-95 opacity-0"),children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-2 dark:text-white",children:"Ch\xe8n li\xean kết"}),c&&(0,i.jsx)("p",{className:"text-red-500 mb-2",children:c}),(0,i.jsx)("input",{type:"text",name:"url",value:r.url,onChange:u,placeholder:"URL",className:"w-full p-2 mb-2 border rounded dark:bg-gray-700 dark:text-white transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,i.jsx)("input",{type:"text",name:"text",value:r.text,onChange:u,placeholder:"Văn bản hiển thị",className:"w-full p-2 mb-2 border rounded dark:bg-gray-700 dark:text-white transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[(0,i.jsx)("input",{type:"checkbox",id:"newWindow",checked:r.target,onChange:e=>s(t=>({...t,target:e.target.checked})),className:"mr-2 transition-colors duration-200 ease-in-out"}),(0,i.jsx)("label",{htmlFor:"newWindow",className:"text-sm dark:text-white",children:"Mở li\xean kết n\xe0y trong cửa sổ mới"})]}),(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)("input",{type:"checkbox",id:"rel",checked:r.rel,onChange:e=>s(t=>({...t,rel:e.target.checked})),className:"mr-2 transition-colors duration-200 ease-in-out"}),(0,i.jsx)("label",{htmlFor:"rel",className:"text-sm dark:text-white",children:"Th\xeam thuộc t\xednh 'rel=nofollow'"})]}),(0,i.jsxs)("div",{className:"flex justify-end",children:[(0,i.jsx)("button",{onClick:()=>{r.url.trim()?h(r.url)?n(r):d("URL kh\xf4ng hợp lệ. Vui l\xf2ng nhập một URL hợp lệ."):d("Vui l\xf2ng nhập cả URL v\xe0 văn bản hiển thị")},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 mr-2 transition-colors duration-200 ease-in-out",children:"Ch\xe8n"}),(0,i.jsx)("button",{onClick:l,className:"bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 transition-colors duration-200 ease-in-out",children:"Hủy"})]})]})})},u=e=>{let{onClick:t}=e,l=(0,a.useMemo)(()=>["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],[]),o=(0,a.useMemo)(()=>[{iconName:"code",title:"Chế độ HTML",type:"html",onClick:()=>t("html")},{divider:!0},{iconName:"",title:"Đoạn",onClick:()=>{},type:"header"},{divider:!0},{iconName:"link",title:"Ch\xe8n li\xean kết",onClick:()=>t("link"),type:"link"},{iconName:"image",title:"Ch\xe8n h\xecnh ảnh",onClick:()=>t("image"),type:"image"},{iconName:"video",title:"Ch\xe8n video",onClick:()=>t("video"),type:"video"},{divider:!0},{iconName:"bold",title:"In đậm",onClick:()=>t("bold"),type:"bold"},{iconName:"italic",title:"In nghi\xeang",onClick:()=>t("italic"),type:"italic"},{iconName:"underline",title:"Gạch ch\xe2n",onClick:()=>t("underline"),type:"underline"},{divider:!0},{iconName:"alignLeft",title:"Căn tr\xe1i",onClick:()=>t("align"),type:"align",value:"left"},{iconName:"alignCenter",title:"Căn giữa",onClick:()=>t("align","center"),type:"align",value:"center"},{iconName:"alignRight",title:"Căn phải",onClick:()=>t("align","right"),type:"align",value:"right"},{iconName:"alignJustify",title:"Căn đều",onClick:()=>t("align","justify"),type:"align",value:"justify"},{divider:!0},{iconName:"textColor",title:"M\xe0u chữ",onClick:()=>{},type:"color"},{iconName:"backgroundColor",title:"M\xe0u nền",onClick:()=>{},type:"background"},{divider:!0}],[t]),r=(0,a.useCallback)((e,a)=>e.divider?(0,i.jsx)("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-2 flex-shrink-0"},"divider-".concat(a)):(0,i.jsxs)("div",{className:"relative group flex-shrink-0",onMouseEnter:e=>{var t,l;null===(l=e.currentTarget.querySelector(".mega-menu"))||void 0===l||null===(t=l.classList)||void 0===t||t.remove("hidden")},onMouseLeave:e=>{var t,l;null===(l=e.currentTarget.querySelector(".mega-menu"))||void 0===l||null===(t=l.classList)||void 0===t||t.add("hidden")},children:[(0,i.jsxs)("button",{onClick:e.onClick,className:"quill-button p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors group relative",type:e.type,value:e.value,children:[(0,i.jsx)(n.J,{iconName:e.iconName,className:"w-5 h-5 text-gray-600 dark:text-gray-300 text-inherit"}),!e.iconName&&(0,i.jsx)("span",{className:"button-title whitespace-nowrap",children:e.title}),(0,i.jsx)("span",{className:"button-tooltip whitespace-nowrap absolute bottom-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.title})]}),("color"===e.type||"background"===e.type)&&(0,i.jsx)("div",{className:"absolute mega-menu left-1/2 -translate-x-1/2 top-full transition group-hover:translate-y-0 translate-y-1 opacity-0 invisible group-hover:opacity-100 group-hover:visible duration-300 ease-in-out group-hover:transform z-10 ",children:(0,i.jsx)("div",{className:"grid grid-cols-5 gap-2 min-w-40 bg-white dark:bg-gray-700 rounded-lg shadow-xl p-2",children:l.map(l=>(0,i.jsx)("button",{onClick:i=>{t(e.type,l),i.currentTarget.closest(".mega-menu").classList.add("hidden")},className:"w-6 h-6 rounded-full",style:{backgroundColor:l}},l))})}),"header"===e.type&&(0,i.jsx)("div",{className:"absolute mega-menu left-1/2 -translate-x-1/2 top-full transition group-hover:translate-y-0 translate-y-1 opacity-0 invisible group-hover:opacity-100 group-hover:visible duration-300 ease-in-out group-hover:transform z-10 ",children:(0,i.jsx)("div",{className:"grid grid-cols-1 gap-2 min-w-40 bg-white dark:bg-gray-700 rounded-lg shadow-xl p-2",children:[{title:"Ti\xeau đề",value:2},{title:"Ti\xeau đề phụ",value:3},{title:"Ti\xeau đề nhỏ",value:4},{title:"Đoạn",value:""}].map(l=>(0,i.jsx)("button",{onClick:i=>{t(e.type,l.value),i.currentTarget.closest(".mega-menu").classList.add("hidden")},value:l.value,className:"w-full text-left p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:l.title},l.title))})})]},e.title),[l,t]);return(0,i.jsxs)(a.Fragment,{children:[(0,i.jsx)("div",{id:"toolbar",className:"hidden"}),(0,i.jsx)("div",{className:"quill-toolbar flex items-center space-x-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-t-lg whitespace-nowrap ",children:o.map(r)})]})},h=l(464);let m=h.C.import("formats/bold"),g=h.C.import("formats/underline"),p=h.C.import("formats/italic"),b=h.C.import("blots/embed"),f=h.C.import("blots/inline");m.tagName="b",g.tagName="u",p.tagName="i";class x extends b{static create(e){var t=null;t="string"==typeof e?{src:e}:e;let l=super.create();return l.setAttribute("src",t.src),t.alt&&l.setAttribute("alt",t.alt||""),t.width&&l.setAttribute("width",t.width||""),t.height&&l.setAttribute("height",t.height||""),t.lazy&&l.setAttribute("loading","lazy"),l}static value(e){return{src:e.getAttribute("src"),alt:e.getAttribute("alt"),width:e.getAttribute("width"),height:e.getAttribute("height"),loading:e.getAttribute("loading")}}}x.blotName="image",x.className="quill-image",x.tagName="img";class y extends b{static create(e){let t=super.create();try{let l=JSON.parse(e["data-value"]);if(console.log("dataValue",l),l.url.includes("youtube.com")||l.url.includes("youtu.be")){let e=l.url.split("v=")[1]||l.url.split("/").pop();t.innerHTML='<div class="quill-video" data-value=\''.concat(JSON.stringify(l),'\' style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; height: auto;"><iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://www.youtube.com/embed/').concat(e,'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>')}else if(l.url.includes("vimeo.com")){let e=l.url.split("/").pop();t.innerHTML='<div class="quill-video" data-value=\''.concat(JSON.stringify(l),'\' style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; height: auto;"><iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://player.vimeo.com/video/').concat(e,'" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div>')}else t.innerHTML='<div class="quill-video" data-value=\''.concat(JSON.stringify(l),'\' style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; height: auto;"><video style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" ').concat(l.controls?"controls":""," ").concat(l.autoplay?"autoplay":"",'><source src="').concat(l.url,'" type="video/mp4">Your browser does not support the video tag.</video></div>');t.setAttribute("data-value",JSON.stringify(l))}catch(e){console.error("Error parsing data-value:",e)}return t}static value(e){return{"data-value":e.getAttribute("data-value")}}}y.blotName="video",y.className="quill-video",y.tagName="span";class v extends f{static create(e){console.log("create",e);let{url:t,target:l,text:i,rel:a}="string"==typeof e?{url:e}:e,n=super.create();return n.setAttribute("href",t),l&&n.setAttribute("target",l?"_blank":""),a&&n.setAttribute("rel",a?"nofollow":""),i&&n.setAttribute("title",i||""),console.log("Creating link: ",n),console.log("Text",n.innerText),n}static formats(e){return{url:e.getAttribute("href"),text:e.innerText,title:e.getAttribute("href"),target:e.getAttribute("target"),nofollow:e.getAttribute("rel")}}static format(e,t){console.log("Formatting blot",{name:e,value:t})}}v.blotName="quill-link",v.tagName="a",h.C.register(g,!0),h.C.register(m,!0),h.C.register(p,!0),h.C.register(x,!0),h.C.register(y,!0),h.C.register(v,!0);var w=a.memo(e=>{let{content:t,onChange:l,placeholder:o="Nhập nội dung...",className:r,setIsHtmlMode:m,isHtmlMode:g}=e,[p,b]=(0,a.useState)(t),f=(0,a.useRef)(null),x=(0,a.useRef)(null),[y,v]=(0,a.useState)({link:{isOpen:!1,url:"",text:"",target:!1,rel:!1},image:{isOpen:!1,url:"",alt:"",width:"",height:"",lazy:!1},video:{isOpen:!1,url:"",width:"",height:"",autoplay:!1,controls:!0}}),[w,k]=(0,a.useState)({isVisible:!1,position:{top:0,left:0},linkElement:null}),N=(0,a.useCallback)(e=>{v(t=>({...t,[e]:{...t[e],isOpen:!1,url:"",text:""}}))},[]),j=(0,a.useCallback)(e=>{b(e),null==l||l(e)},[l]);(0,a.useEffect)(()=>{t&&t!==p&&!g&&b(t)},[t,p,g]);let C=(0,a.useCallback)((e,t)=>{let l=f.current.getEditor(),i=l.getFormat();l.format(e,void 0!==t?t:!i[e])},[]),O=(0,a.useCallback)((e,t)=>{let l=f.current.getEditor(),i=x.current||l.getSelection();i&&l.insertEmbed(i.index,e,t,"user")},[]),S=(0,a.useCallback)((e,t)=>{(t.url||!g)&&(O(e,t),N(e))},[g,O,N]),L=(0,a.useCallback)(e=>{if(!e.url&&g)return;let t=f.current.getEditor(),l=x.current||t.getSelection();if(!l)return;let i=t.getFormat();e.text?(t.deleteText(l.index,l.length),t.insertText(l.index,e.text,{...i,"quill-link":e})):t.format("quill-link",e),N("link")},[g,N]),E=(0,a.useCallback)(()=>{let e=f.current.getEditor(),t=document.querySelectorAll(".quill-toolbar .quill-button"),l=e.getFormat();t.forEach(e=>{let t=e.getAttribute("type"),i=e.getAttribute("value"),a=l[t]===i||"align"===t&&(l[t]||"left")===i;if(e.classList.toggle("bg-gray-400",a),e.classList.toggle("text-white",a),e.classList.toggle("dark:bg-gray-800",a),"header"===t){let i=e.parentElement.querySelector('button[value="'.concat(l[t],'"]')),a=i?i.innerHTML:"Đoạn",n=e.querySelector(".button-title"),o=e.querySelector(".button-tooltip");n&&(n.innerText=a),o&&(o.innerText=a)}})},[]);(0,a.useEffect)(()=>{let e=f.current.getEditor(),t=e=>{e&&E(e)},l=e=>{if("IMG"===e.target.tagName&&console.log("Clicked image:",e.target.src),"A"===e.target.tagName){console.log("Clicked a:",e.target);let t=e.target.getBoundingClientRect();k({isVisible:!0,position:{top:t.bottom+window.scrollY+5,left:t.left+window.scrollX},linkElement:e.target})}};return e.on("selection-change",t),e.on("text-change",E),e.root.addEventListener("click",l),()=>{e.off("selection-change",t),e.off("text-change",E),e.root.removeEventListener("click",l)}},[E]);let M=(0,a.useCallback)(e=>{var t;(null==w?void 0:null===(t=w.linkElement)||void 0===t?void 0:t.contains(e.target))||e.target.closest("#quill-tooltip")||k({isVisible:!1,position:{top:0,left:0},linkElement:null})},[w]),z=(0,a.useCallback)((e,t)=>{var l,i;let a=null==f?void 0:null===(l=f.current)||void 0===l?void 0:l.getEditor();if(!a)return;x.current=a.getSelection();let n={html:()=>m(!0),link:()=>v(e=>({...e,link:{...e.link,isOpen:!0}})),image:()=>v(e=>({...e,image:{...e.image,isOpen:!0}})),video:()=>v(e=>({...e,video:{...e.video,isOpen:!0}})),bold:()=>C("bold"),italic:()=>C("italic"),underline:()=>C("underline"),align:()=>C("align",t),color:()=>C("color",t),background:()=>C("background",t),header:()=>C("header",t)};null===(i=n[e])||void 0===i||i.call(n)},[m,C]),q=(0,a.useMemo)(()=>({toolbar:"#toolbar"}),[]),A=(0,a.useMemo)(()=>["bold","italic","underline","quill-link","align","image","video","code","color","background","header"],[]);(0,a.useEffect)(()=>(document.addEventListener("click",M),()=>{document.removeEventListener("click",M)}),[M]);let T=(0,a.useCallback)(()=>{let{"quill-link":e}=f.current.getEditor().getFormat();e&&v(t=>({...t,link:{...t.link,...e,isOpen:!0}})),k({isVisible:!1,position:{top:0,left:0},linkElement:null})},[]),R=(0,a.useCallback)(()=>{k({isVisible:!1,position:{top:0,left:0},linkElement:null})},[]);return(0,i.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md ".concat(r),children:[(0,i.jsx)(u,{onClick:z}),(0,i.jsx)(h.Z,{ref:f,value:p,onChange:j,placeholder:o,modules:q,className:"bg-white dark:bg-gray-800 relative",theme:"snow",formats:A}),(0,i.jsx)(s,{isOpen:y.image.isOpen,onClose:()=>N("image"),onInsert:e=>S("image",e)}),(0,i.jsx)(c,{isOpen:y.video.isOpen,onClose:()=>N("video"),onInsert:e=>S("video",e)}),(0,i.jsx)(d,{data:y.link,onClose:()=>N("link"),onInsert:L}),w.isVisible&&(0,i.jsxs)("div",{id:"quill-tooltip",className:"tooltip absolute bg-gray-200 text-black text-sm rounded-md p-2 shadow-md",style:{top:w.position.top,left:w.position.left},children:[(0,i.jsx)("div",{className:"absolute",style:{top:"-4px",left:"15px",transform:"translateX(-50%)"},children:(0,i.jsx)("div",{className:"w-0 h-0 border-l-4 border-r-4 border-b-4 border-transparent border-b-gray-200"})}),(0,i.jsxs)("div",{className:"flex justify-around items-center gap-1",children:[(0,i.jsxs)("button",{className:"bg-blue-500 text-white py-1 px-2 rounded hover:bg-blue-600 flex items-center",onClick:T,children:[(0,i.jsx)(n.J,{iconName:"edit",className:"w-4 mr-1 h-4"}),"Chỉnh sửa"]}),(0,i.jsxs)("button",{className:"bg-red-500 text-white py-1 px-2 rounded hover:bg-red-600 flex items-center",onClick:R,children:[(0,i.jsx)(n.J,{iconName:"x",className:"mr-1 w-4 h-4"}),"Gỡ link"]})]})]})]})}),k=l(7421),N=l(1884),j=l(1312),C=l(4935),O=l(6965),S=l(5383),L=e=>{let{content:t,onChange:l,setIsHtmlMode:o,className:r,isHtmlMode:u}=e,h=(0,a.useRef)(null),[m,g]=(0,a.useState)(null),[p,b]=(0,a.useState)({isOpen:!1,url:"",text:"",newWindow:!1,nofollow:!1}),[f,x]=(0,a.useState)({isOpen:!1,url:"",alt:"",width:"",height:"",lazy:!1}),[y,v]=(0,a.useState)({isOpen:!1,url:"",width:"",height:"",autoplay:!1,controls:!0}),w=(0,a.useCallback)(async e=>{try{return await C.WU(e,{parser:"html",plugins:[O],tabWidth:2,useTabs:!0,singleQuote:!1,semi:!0,bracketSpacing:!0,arrowParens:"always",htmlWhitespaceSensitivity:"css",endOfLine:"lf"})}catch(t){return console.error("Error formatting HTML:",t),e}},[]),L=(0,a.useCallback)(e=>{if((m||u)&&e.url&&e.text){let t=['href="'.concat(e.url,'"'),e.newWindow&&'target="_blank"',e.nofollow&&'rel="nofollow"'].filter(Boolean).join(" ");m.dispatch({changes:{from:m.state.selection.main.from,insert:"<a ".concat(t,">").concat(e.text,"</a>")}}),b({isOpen:!1,url:"",text:"",newWindow:!1,nofollow:!1})}},[m,u]),E=(0,a.useCallback)(e=>{if((m||u)&&e.url){let t=['src="'.concat(e.url,'"'),'alt="'.concat(e.alt||"",'"'),e.width&&'width="'.concat(e.width,'"'),e.height&&'height="'.concat(e.height,'"'),e.lazy&&'loading="lazy"'].filter(Boolean).join(" ");m.dispatch({changes:{from:m.state.selection.main.from,insert:"<img ".concat(t,' class="quill-image" style="max-width: 100%;"/>')}}),x({isOpen:!1,url:"",alt:"",width:"",height:"",lazy:!1})}},[m,u]),M=(0,a.useCallback)(e=>{if(console.log("insertVideo",e,"isHtmlMode",u),(e.url||u)&&e.url){let t="";if(e.url.includes("youtube.com")||e.url.includes("youtu.be")){let l=e.url.split("v=")[1]||e.url.split("/").pop();t='<span class="quill-video" data-value=\''.concat(JSON.stringify(e),'\' style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; height: auto;"><iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://www.youtube.com/embed/').concat(l,'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></span>')}else if(e.url.includes("vimeo.com")){let l=e.url.split("/").pop();t='<span class="quill-video" data-value=\''.concat(JSON.stringify(e),'\' style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; height: auto;"><iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://player.vimeo.com/video/').concat(l,'" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></span>')}else t='<span class="quill-video" data-value=\''.concat(JSON.stringify(e),'\' style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; height: auto;"><video style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" ').concat(e.controls?"controls":""," ").concat(e.autoplay?"autoplay":"",'><source src="').concat(e.url,'" type="video/mp4">Your browser does not support the video tag.</video></span>');m.dispatch({changes:{from:m.state.selection.main.from,insert:t}}),v({isOpen:!1,url:"",width:"",height:"",autoplay:!1,controls:!0})}},[m,u]),z=(0,a.useCallback)(e=>{if(!m&&u)return;let{from:t,to:l}=m.state.selection.main;m.dispatch({changes:[{from:t,insert:"<".concat(e,">")},{from:l,insert:"</".concat(e,">")}]})},[m,u]);(0,a.useEffect)(()=>{if(!h.current)return;let e=(async()=>{let e=await w(t),i=new k.tk({extensions:[N.Xy,(0,j.dy)(),k.$f.of([S.oc,{key:"Ctrl-i",run:()=>(z("i"),!0)},{key:"Ctrl-b",run:()=>(z("b"),!0)},{key:"Ctrl-u",run:()=>(z("u"),!0)}])],parent:h.current,doc:e,dispatch:e=>{i.update([e]),e.docChanged&&l(i.state.doc.toString())}});return g(i),()=>i.destroy()})();return()=>{e.then(e=>e())}},[]),(0,a.useEffect)(()=>{m&&t!==m.state.doc.toString()&&!u&&(async()=>{let e=await w(t);m.dispatch({changes:{from:0,to:m.state.doc.length,insert:e}})})()},[t,m,w]);let q=[{iconName:"pencil",title:"Chế độ trực quan",onClick:()=>o(!1)},{divider:!0},{iconName:"link",title:"Ch\xe8n li\xean kết",onClick:()=>b(e=>({...e,isOpen:!0}))},{iconName:"image",title:"Ch\xe8n h\xecnh ảnh",onClick:()=>x(e=>({...e,isOpen:!0}))},{iconName:"video",title:"Ch\xe8n video",onClick:()=>v(e=>({...e,isOpen:!0}))},{divider:!0},{iconName:"bold",title:"In đậm",onClick:()=>z("b")},{iconName:"italic",title:"In nghi\xeang",onClick:()=>z("i")},{iconName:"underline",title:"Gạch ch\xe2n",onClick:()=>z("u")},{divider:!0},{iconName:"refresh",title:"Định dạng HTML",onClick:async()=>{if(m){let e=m.state.doc.toString(),t=await w(e);m.dispatch({changes:{from:0,to:m.state.doc.length,insert:t}})}}}];return(0,i.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md ".concat(r),children:[(0,i.jsx)("div",{className:"toolbar flex items-center space-x-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-t-lg ",children:q.map((e,t)=>e.divider?(0,i.jsx)("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-2"},"divider-".concat(t)):(0,i.jsxs)("button",{onClick:e.onClick,className:"p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors group relative",children:[(0,i.jsx)(n.J,{iconName:e.iconName,className:"w-5 h-5 text-gray-600 dark:text-gray-300"}),(0,i.jsx)("span",{className:"whitespace-nowrap absolute bottom-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.title})]},e.title))}),(0,i.jsx)("div",{ref:h,className:""}),(0,i.jsx)(s,{isOpen:f.isOpen,onClose:()=>{x({isOpen:!1,url:"",alt:"",width:"",height:""})},onInsert:E}),(0,i.jsx)(c,{isOpen:y.isOpen,onClose:()=>{v({isOpen:!1,url:"",width:"",height:"",autoplay:!1,controls:!0})},onInsert:M}),(0,i.jsx)(d,{data:p,onClose:()=>{b({isOpen:!1,url:"",text:"",newWindow:!1,nofollow:!1})},onInsert:L})]})},E=e=>{let[t,l]=(0,a.useState)(!1);return t?(0,i.jsx)(L,{...e,className:t?"":"hidden",setIsHtmlMode:l,isHtmlMode:t}):(0,i.jsx)(w,{...e,className:t?"hidden":"",setIsHtmlMode:l,isHtmlMode:t})}}}]);